
import streamlit as st

# ------------------ 타이틀 ------------------
st.title("부동산 취득세 & 중개수수료 계산기")

# ------------------ 입력 폼 ------------------
st.header("1. 기본 정보 입력")

거래유형 = st.selectbox("거래유형", ["매매", "증여", "상속", "원시취득"])
부동산종류 = st.selectbox("부동산 종류", ["주택", "오피스텔", "농지", "그 외"])
면적 = st.selectbox("전용면적", ["40㎡ 미만", "60㎡ 미만", "80㎡ 미만", "85㎡ 이상"])
주택보유수 = st.selectbox("주택 보유 수", ["1주택", "2주택", "3주택", "4주택 이상"])
소유자형태 = st.multiselect("소유자 형태", ["법인", "임대사업자", "최초분양"])
지역옵션 = st.multiselect("지역 조건", ["조정대상지역", "수도권", "중과 배제"])
특례옵션 = st.checkbox("생애최초 구입")

st.header("2. 금액 정보 입력")
취득가액 = st.number_input("취득가액 (만원)", min_value=0)
시가표준액 = st.number_input("시가표준액 (만원)", min_value=0)

# ------------------ 계산 함수 ------------------
def calculate_acquisition_tax():
    base = 시가표준액 if 시가표준액 > 0 else 취득가액
    세율 = 0.04  # 기본값

    if 거래유형 == "매매" and 부동산종류 == "주택":
        if 주택보유수 == "1주택":
            if base <= 6000:
                세율 = 0.01
            elif base <= 9000:
                세율 = 0.01 + (base - 6000) * 0.0000025
                세율 = min(세율, 0.03)
            else:
                세율 = 0.03

            if 특례옵션 and base <= 6000:
                세율 = 0.008
        elif 주택보유수 == "2주택":
            세율 = 0.08 if "조정대상지역" in 지역옵션 else 0.02
        elif 주택보유수 == "3주택":
            세율 = 0.12 if "조정대상지역" in 지역옵션 else 0.03
        else:
            세율 = 0.13 if "조정대상지역" in 지역옵션 else 0.04

    elif 거래유형 == "매매" and 부동산종류 != "주택":
        if base <= 5000:
            세율 = 0.02
        elif base <= 8000:
            세율 = 0.03
        else:
            세율 = 0.04

    elif 거래유형 == "증여":
        세율 = 0.035
    elif 거래유형 == "상속":
        세율 = 0.025
    elif 거래유형 == "원시취득":
        세율 = 0.02

    if "법인" in 소유자형태:
        세율 = max(세율, 0.12)

    취득세 = base * 세율
    농어촌특별세 = 0
    지방교육세 = 0

    if not (주택보유수 == "1주택" and base <= 6000 and 특례옵션):
        지방교육세 = 취득세 * 0.1

    if ("조정대상지역" in 지역옵션) and (주택보유수 in ["2주택", "3주택", "4주택 이상"]):
        농어촌특별세 = 취득세 * 0.2

    총합계 = int(취득세 + 지방교육세 + 농어촌특별세)
    return int(취득세), int(지방교육세), int(농어촌특별세), 총합계

def calculate_broker_fee():
    거래금액 = 취득가액
    수수료 = 0

    if 부동산종류 == "주택":
        if 거래금액 <= 5000:
            수수료 = 거래금액 * 0.006
        elif 거래금액 <= 2_0000:
            수수료 = 거래금액 * 0.005
        elif 거래금액 <= 6_0000:
            수수료 = 거래금액 * 0.004
        elif 거래금액 <= 9_0000:
            수수료 = 240 + (거래금액 - 6_0000) * 0.005
        else:
            수수료 = 거래금액 * 0.009
    else:
        수수료 = 거래금액 * 0.009

    return int(수수료)

# ------------------ 출력 ------------------
if st.button("계산하기"):
    취득세, 지방교육세, 농어촌특별세, 총합계 = calculate_acquisition_tax()
    fee = calculate_broker_fee()

    st.subheader("📌 결과")
    st.write(f"✅ 취득세: {취득세:,} 만원")
    st.write(f"➕ 지방교육세: {지방교육세:,} 만원")
    st.write(f"➕ 농어촌특별세: {농어촌특별세:,} 만원")
    st.write(f"💰 총 납부세액: {총합계:,} 만원")
    st.write(f"✅ 중개수수료: {fee:,} 만원")
    st.success("계산이 완료되었습니다.")
